% MTPB.TEX  VERSION 1.0  (January 2005)
% COPYRIGHT (C) 2005 BY PUBLISH OR PERISH, INC.

\expandafter\edef\csname qqcode\string @\endcsname{\the\catcode`\"}
\expandafter\edef\csname atcode\string @\endcsname{\the\catcode`\@}

\expandafter\ifx\csname s\string @b\string @\endcsname\relax
 \errmessage{File mtp.tex must be \string\input\space first}\fi
\catcode`\@=11
\catcode`\"=12   

\def\altx{\errmessage{Invalid use of \string\altx}}
\def\alty{\errmessage{Invalid use of \string\alty}}
\def\altY{\errmessage{Invalid use of \string\altY}}
\def\altG{\errmessage{Invalid use of \string\altG}}
\def\altQ{\errmessage{Invalid use of \string\altQ}}
\def\altZ{\errmessage{Invalid use of \string\altZ}}
\def\altr{\errmessage{Invalid use of \string\altr}}
\def\altz{\errmessage{Invalid use of \string\altz}}
\def\altC{\errmessage{Invalid use of \string\altC}}
\def\altL{\errmessage{Invalid use of \string\altL}}


\def\loadmfrakAt@#1#2#3{%
 \alloc@@8\fam\chardef\sixt@@n\mtmfrak@
 \edef\mtmfrak@@{\hexnumber@\mtmfrak@}
 \dimen@#1\relax\PSZ@
 \FONT@{mtmft}\nextiii@\textfont\mtmfrak@\next@
 \dimen@#2\relax\PSZ@
 \FONT@{mtmfs}\nextiii@\scriptfont\mtmfrak@\next@
 \dimen@#3\relax\PSZ@
 \FONT@{mtmff}\nextiii@\scriptscriptfont\mtmfrak@\next@
 \def\mfrak{\futurelet\next\mfrak@}%
 \def\mfrak@{\ifx\next\imath\def\next@####1{\mathchar"0\mtmfrak@@7B}%
 \else\ifx\next\jmath\def\next@####1{\mathchar"0\mtmfrak@@7C}%
 \else\ifx\next\altx\def\next@####1{\mathchar"0\mtmfrak@@38}%
 \else\ifx\next\alty\def\next@####1{\mathchar"0\mtmfrak@@39}%
 \else\ifx\next\altY\def\next@####1{\mathchar"0\mtmfrak@@19}%
 \else\def\next@####1{\fam\mtmfrak@####1}\fi\fi\fi\fi\fi
 \next@}
}
\def\loadmfrak{\loadmfrakAt@\tMTPsize\sMTPsize\fMTPsize}


\def\loadbmfrakAt@#1#2#3{%
 \alloc@@8\fam\chardef\sixt@@n\mtbmfrak@
 \edef\mtbmfrak@@{\hexnumber@\mtbmfrak@}
 \dimen@#1\relax\PSZ@
 \FONT@{mtbmft}\nextiii@\textfont\mtbmfrak@\next@
 \dimen@#2\relax\PSZ@
 \FONT@{mtbmfs}\nextiii@\scriptfont\mtbmfrak@\next@
 \dimen@#3\relax\PSZ@
 \FONT@{mtbmff}\nextiii@\scriptscriptfont\mtbmfrak@\next@
 \def\bmfrak{\futurelet\next\bmfrak@}%
 \def\bmfrak@{\ifx\next\imath\def\next@####1{\mathchar"0\mtbmfrak@@7B}%
 \else\ifx\next\jmath\def\next@####1{\mathchar"0\mtbmfrak@@7C}%
 \else\ifx\next\altx\def\next@####1{\mathchar"0\mtbmfrak@@38}%
 \else\ifx\next\alty\def\next@####1{\mathchar"0\mtbmfrak@@39}%
 \else\ifx\next\altY\def\next@####1{\mathchar"0\mtbmfrak@@19}%
 \else\def\next@####1{\fam\mtbmfrak@####1}\fi\fi\fi\fi\fi
 \next@}
}
\def\loadbmfrak{\loadbmfrakAt@\tMTPsize\sMTPsize\fMTPsize}

\def\loadmscriptAt@#1#2#3{%
 \alloc@@8\fam\chardef\sixt@@n\mtmscript@
 \edef\mtmscript@@{\hexnumber@\mtmscript@}
 \dimen@#1\relax\PSZ@
 \FONT@{mtmst}\nextiii@\textfont\mtmscript@\next@ \skewchar\next@42
 \dimen@#2\relax\PSZ@
 \FONT@{mtmss}\nextiii@\scriptfont\mtmscript@\next@ \skewchar\next@42
 \dimen@#3\relax\PSZ@
 \FONT@{mtmsf}\nextiii@\scriptscriptfont\mtmscript@\next@ \skewchar\next@42
 \def\mscript{\futurelet\next\mscript@}%
 \def\mscript@{\ifx\next\imath\def\next@####1{\mathchar"0\mtmscript@@7B}%
 \else\ifx\next\jmath\def\next@####1{\mathchar"0\mtmscript@@7C}%
 \else\ifx\next\altG\def\next@####1{\mathchar"0\mtmscript@@07}%
 \else\ifx\next\altQ\def\next@####1{\mathchar"0\mtmscript@@11}%
 \else\ifx\next\altY\def\next@####1{\mathchar"0\mtmscript@@19}%
 \else\ifx\next\altZ\def\next@####1{\mathchar"0\mtmscript@@1A}%
 \else\ifx\next\altr\def\next@####1{\mathchar"0\mtmscript@@32}%
 \else\ifx\next\altz\def\next@####1{\mathchar"0\mtmscript@@3A}%
 \else\ifx\next\altC\def\next@####1{\mathchar"0\mtmscript@@03}%
 \else\ifx\next\altL\def\next@####1{\mathchar"0\mtmscript@@0C}%
 \else\def\next@####1{\fam\mtmscript@####1}\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi
 \next@}
}
\def\loadmscript{\loadmscriptAt@\tMTPsize\sMTPsize\fMTPsize}


\def\loadbmscriptAt@#1#2#3{%
 \alloc@@8\fam\chardef\sixt@@n\mtbmscript@
 \edef\mtbmscript@@{\hexnumber@\mtbmscript@}
 \dimen@#1\relax\PSZ@
 \FONT@{mtbmst}\nextiii@\textfont\mtbmscript@\next@ \skewchar\next@42
 \dimen@#2\relax\PSZ@
 \FONT@{mtbmss}\nextiii@\scriptfont\mtbmscript@\next@ \skewchar\next@42
 \dimen@#3\relax\PSZ@
 \FONT@{mtbmsf}\nextiii@\scriptscriptfont\mtbmscript@\next@ \skewchar\next@42
 \def\bmscript{\futurelet\next\bmscript@}%
 \def\bmscript@{\ifx\next\imath\def\next@####1{\mathchar"0\mtbmscript@@7B}%
 \else\ifx\next\jmath\def\next@####1{\mathchar"0\mtbmscript@@7C}%
 \else\ifx\next\altG\def\next@####1{\mathchar"0\mtbmscript@@07}%
 \else\ifx\next\altQ\def\next@####1{\mathchar"0\mtbmscript@@11}%
 \else\ifx\next\altY\def\next@####1{\mathchar"0\mtbmscript@@19}%
 \else\ifx\next\altZ\def\next@####1{\mathchar"0\mtbmscript@@1A}%
 \else\ifx\next\altr\def\next@####1{\mathchar"0\mtbmscript@@32}%
 \else\ifx\next\altz\def\next@####1{\mathchar"0\mtbmscript@@3A}%
 \else\ifx\next\altC\def\next@####1{\mathchar"0\mtbmscript@@03}%
 \else\ifx\next\altL\def\next@####1{\mathchar"0\mtbmscript@@0C}%
 \else\def\next@####1{\fam\mtbmscript@####1}\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi
 \next@}
}
\def\loadbmscript{\loadbmscriptAt@\tMTPsize\sMTPsize\fMTPsize}


\catcode`\"=\qqcode@
\catcode`\@=\atcode@


